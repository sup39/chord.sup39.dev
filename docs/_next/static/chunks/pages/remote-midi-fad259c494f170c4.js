(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[247],{6185:function(t,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/remote-midi",function(){return n(545)}])},652:function(t,e,n){"use strict";n.d(e,{Z:function(){return r}});var l=n(5893);let o=new Proxy([{color:"white",x:0},{color:"black",x:13},{color:"white",x:22.5},{color:"black",x:40},{color:"white",x:45},{color:"white",x:67.5},{color:"black",x:79.5},{color:"white",x:90},{color:"black",x:105.5},{color:"white",x:112.5},{color:"black",x:131.5},{color:"white",x:135}].map(t=>({...t,..."white"===t.color?{w:22.5,h:75}:{w:14,h:47.5}})),{get(t,e){if("symbol"==typeof e)return;let n=parseInt(e),l=t[n%12];return{...l,x:l.x+157.5*Math.floor(n/12)}}});function r(t){let{base:e=0,keyCount:n=24,points:r=[],shiftPoints:c=!0,margin:i=10,strokeWidth:s=1,pointColor:a="#f9f",whiteColor:u="#eee",blackColor:d="#000",whiteStroke:h="#000"}=t,x=Array.from({length:n},(t,n)=>o[e+n]),f=x[x.length-1],p=x[0].x,m=f.x+f.w-p;if(c){let w=Math.min(...r),b=12*Math.floor((w-e)/12);r=r.map(t=>t-b)}return(0,l.jsxs)("svg",{viewBox:"".concat(p-i," ").concat(-i," ").concat(m+2*i," ").concat(75+2*i),children:[x.filter(t=>"white"===t.color).map(t=>(0,l.jsx)("rect",{x:t.x,y:0,width:t.w,height:t.h,fill:u,stroke:h,strokeWidth:s},"w"+t.x)),x.filter(t=>"black"===t.color).map(t=>(0,l.jsx)("rect",{x:t.x,y:0,width:t.w,height:t.h,fill:d},"b"+t.x)),r.map(t=>{let{x:e,w:n,h:r}=o[t];return(0,l.jsx)("circle",{cx:e+n/2,cy:r-12,r:4,fill:a},"c"+t)})]})}},2962:function(t,e,n){"use strict";n.d(e,{Z:function(){return l}});var l=(0,n(4625).f)({site:{startYear:2023,author:"サポミク",title:"サポミク",subtitle:"和音練習",icon:"https://res.sup39.dev/icon.svg"},metaFields:[{attr:"author",label:"作者："},{attr:"createdAt",label:"作成日時："},{attr:"updatedAt",label:"更新日時："}],nav:[{label:"カスタマイズ練習",path:"customized"}]})},545:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return d}});var l=n(5893),o=n(7294),r=n(931),c=n(9367),i=n(2962),s=n(652);let a={title:"リモートMIDI",description:"socket.ioを使ってMIDI入力をリモートに送信するツールです"},u=new URLSearchParams(window.location.search).get("url");function d(t){let{router:e}=t,[n,d]=(0,o.useState)(null!=u?u:""),[{text:h,disabled:x,connected:f},p]=(0,o.useState)({text:"",disabled:!1,connected:!1}),m=(0,o.useRef)(),[w,b]=(0,o.useState)({correct:null,correctCount:0,totalCount:0,timer:null,totalTimeC:0,prompt:"",notes:[],solution:[]}),v=(0,o.useRef)(t=>{p({text:"Connecting...",disabled:!0,connected:!1});let e=(0,c.io)(t,{reconnection:!1});e.on("connect",()=>{p({text:"Connected",disabled:!0,connected:!0})}),e.on("connect_error",e=>{console.error(e),p({text:"Fail to connect to ".concat(t),disabled:!1,connected:!1})}),e.on("state",t=>{b(e=>({...e,...t}))}),m.current=e});return(0,o.useEffect)(()=>{u&&v.current(u),(0,r.r)().then(t=>{let[e]=t;if(null==e){alert("MIDI not found");return}e.onmidimessage=t=>{let{data:e}=t;if(3!==e.byteLength)return;let n=m.current;null!=n&&n.emit("midi",e)}})},[]),(0,l.jsx)(i.Z,{meta:a,headings:[],router:e,children:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("section",{children:[(0,l.jsxs)("form",{onSubmit:t=>{t.preventDefault(),v.current(n)},children:[(0,l.jsx)("span",{children:"Server URL: "}),(0,l.jsx)("input",{value:n,onChange:t=>d(t.target.value)}),(0,l.jsx)("input",{type:"submit",value:"Connect",disabled:x,style:{marginLeft:"0.5em"}})]}),(0,l.jsx)("div",{children:h})]}),f&&(0,l.jsxs)("section",{children:[(0,l.jsxs)("section",{children:[(0,l.jsx)("div",{className:"Prompt",children:(0,l.jsxs)("span",{children:[w.correctCount," ","/"," ",w.totalCount]})}),(0,l.jsxs)("div",{children:["平均時間：",0===w.correctCount?"N/A":(w.totalTimeC/w.correctCount/1e3).toFixed(3)+"秒"]}),(0,l.jsxs)("div",{children:["回答時間：",null==w.timer?"":(w.timer/1e3).toFixed(3)+"秒"]}),(0,l.jsx)("div",{className:"Prompt",children:w.prompt})]}),(0,l.jsxs)("section",{children:[(0,l.jsx)("h4",{children:"回答"}),(0,l.jsx)(s.Z,{points:w.notes,pointColor:"#66f",shiftPoints:!0})]}),w.prompt&&null!=w.correct&&(0,l.jsxs)("section",{children:[(0,l.jsx)("h4",{children:w.correct?"正解！":"不正解"}),(0,l.jsx)(s.Z,{points:w.solution,pointColor:"#f9f",shiftPoints:!0})]})]})]})})}},931:function(t,e,n){"use strict";async function l(){if(!("requestMIDIAccess"in navigator))return[];let{inputs:t}=await navigator.requestMIDIAccess();return Array.from(t.values())}n.d(e,{$:function(){return o},r:function(){return l}});class o{noteOn(t){var e,n,l,o;this.notes.add(t),null===(n=(e=this.callback).noteChanged)||void 0===n||n.call(e,t),null===(o=(l=this.callback).noteOn)||void 0===o||o.call(l,t)}noteOff(t){var e,n,l,o;this.notes.delete(t),null===(n=(e=this.callback).noteChanged)||void 0===n||n.call(e,t),null===(o=(l=this.callback).noteOff)||void 0===o||o.call(l,t)}pedal(t,e){var n,l,o,r;let c=this.pedals.has(t),i=e>0;i!==c&&(this.pedals[i?"add":"delete"](t),null===(l=(n=this.callback).pedalChanged)||void 0===l||l.call(n,t),null===(r=(o=this.callback)[i?"pedalOn":"pedalOff"])||void 0===r||r.call(o,t))}clear(){this.notes.clear(),this.pedals.clear()}constructor(t={}){this.callback=t,this.notes=new Set,this.pedals=new Set}}}},function(t){t.O(0,[625,367,774,888,179],function(){return t(t.s=6185)}),_N_E=t.O()}]);